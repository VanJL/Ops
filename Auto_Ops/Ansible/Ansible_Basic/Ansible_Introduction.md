# Ansible Introduction



## What is



## Features



### 幂等性（idempotence）



#### 幂等性介绍

如果执行同一个动作多次，对被执行对象的影响的结果状态总是一致的,就可以称为**幂等性**。



#### 数学上的幂等性

如果一个函数多次运算，得到的结果一致，则此函数具有**幂等性（idempotent）。**

符合幂等性的一元函数公式如下所示：

```text
f(fx)) = f(x)
```

**恒等**函数满足幂等性 - 输入和输出相等的函数

```text
f(x) = x
```

**常数**函数满足幂等性 - 无论输入为什么，输出都是相同的结果

```text
f(x) = Constant
```



#### 在实际情况中什么是幂等的呢？

- SQL语句对数据的读取操作是幂等的。
- SQL语句对数据的修改操作如果只是修改固定的单一数值，这个操作也是幂等的。
- HTTP的GET和PUT操作是幂等的，“GET“和“PUT”保证多次执行产生相同的结果，所以是符合幂等性的，而“POST”则不符合幂等性。

在 ansible 中，有很多 module 是具有幂等性的，这些 module 的操作和逻辑可以通过提前一步来校验是否已经实现修改(或者为预期的状态)，如果多次重复这个操作的话，已经实现修改(或者为预期的状态)那么就会忽略此次动作。



#### 在实际情况中什么是不幂等的呢？

很多 ansible 的模块是不幂等的，比如 command 模块， shell 模块 raw 模块。

这些模块并不会检测状态，也就是说我们使用这些不幂等的模块来操作的时候，重复执行这个模块的命令时，每次都会重复这个内容。

比如向一个文件来插入内容 “insert devnetsg”，多次执行就会插入多次。

```text
...
“insert devnetsg“
“insert devnetsg“
“insert devnetsg“
...
```



#### 幂等性原理

Ansible中的幂等性的实现，实际上是得益于它很多module中的Python代码，很多模块的代码中就写了很多检查比对之类的方法